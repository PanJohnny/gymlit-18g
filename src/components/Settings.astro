---
interface Props {
    visible?:boolean
}

const {visible} = Astro.props as Props;

let v = "true";

if (!visible) {
    v = "false";
}
---

<div class="settings inverted" data-visible={v}>
    <h2>Nastaven칤</h2>
    <div>
        <ol>
            <li><label><input type="checkbox" id="darkMode"> Tmav칳 re쬴m 游꺀</label></li>
            <li><label><input type="checkbox" id="oldVersion"> Preferovat starou verzi 游놊</label></li>
            <li><input type="button" role="button" onclick="window.location.href = '/settings/apply#cookies';" value="Vymazat data" /> Vyma쬰 v코echny data 游딈 (sma쬰: preference, autoriza캜n칤 cookie, posledn칤 prohl칤쬰n치 str치nka cookie, statistick칳 identifik치tor)</a></li>
        </ol>
    </div>
    <span id="doneSettings" role="button">Hotovo</span>
</div>

<style>
    .settings {
        position: fixed;
        z-index: 2;
        border-style: solid;
        border-radius: 10px;
        border-color: var(--border-color);
        padding: 1em;
        border-width: 2px;

        top: 40vh;
        left: 50vw;
        transform: translate(-50%, -50%);
    }

    .settings[data-visible="false"] {
        display: none;
    }
    
    #doneSettings {
        right: .2em;
    }
</style>

<script>
    function closeSettings() {
        document.querySelector(".settings").setAttribute("data-visible", "false");
    }

    document.querySelector("#doneSettings").addEventListener("click", closeSettings);

    document.querySelector("#darkMode").addEventListener("change", (e) => {
        if (e.currentTarget["checked"]) {
            document.querySelector("html").className = "dark";
            localStorage.setItem("mode", "dark");
        } else {
            document.querySelector("html").className = "light";
            localStorage.setItem("mode", "light");
        }
    });

    document.querySelector("#darkMode")["checked"] = localStorage.getItem("mode") == "dark";

    document.querySelector("#oldVersion").addEventListener("change", (e) => {
        localStorage.setItem("old", e.currentTarget["checked"])
    });

    document.querySelector("#oldVersion")["checked"] = localStorage.getItem("old") == "true";
</script>
